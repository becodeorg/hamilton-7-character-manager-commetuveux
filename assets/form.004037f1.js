import{a as i}from"./axios.da025002.js";(async()=>{document.addEventListener("trix-before-initialize",()=>{}),document.querySelector("input[type=file]").addEventListener("change",u);function u(){let a=document.querySelector("input[type=file]").files;if(a.length>0){let t=a[0],e=new FileReader;e.onload=function(r){let o=r.target.result;pictureImage.src=o,console.log(document.getElementById("pictureImage").src)},e.readAsDataURL(t)}}const d=window.location.href;if(new URL(d).search.split("?")[1]===void 0)document.querySelector("#form_Submit").addEventListener("click",a=>{a.preventDefault();const t=Array.from(document.querySelectorAll("input[type=text], textarea")).map(({value:c})=>c.trim()),[e,r,o]=t,n=document.getElementById("pictureImage").src.replace("data:image/","").replace(/^.+,/,"");if(console.log(t),confirm(`You are about to create a new entry for ${t[0]}. Is that what you want ?`))try{i.post("https://character-database.becode.xyz/characters",{image:n,name:e,shortDescription:r,description:o}),alert("Character successfully added!"),window.location.href="index.html"}catch{console.log("There was une couille dans le p\xE2t\xE9")}});else{const a=window.location.href,t=new URL(a).search.split("?")[1];try{const e=await(await i.get(`https://character-database.becode.xyz/characters/${t}`)).data;console.log(e),console.log(t);const r=document.querySelector('input[name="name"]'),o=document.querySelector('input[name="nickname"]'),n=document.querySelector("textarea"),c=document.querySelector("#pictureImage");console.log(c),r.value=e.name,o.value=e.shortDescription,n.value=e.description,c.src=`data:image;base64,${e.image}`,document.querySelector("#form_Submit").addEventListener("click",m=>{m.preventDefault();const l=Array.from(document.querySelectorAll("input[type=text], textarea")).map(({value:f})=>f.trim()),[p,h,y]=l,s=document.getElementById("pictureImage").src.replace("data:image/","").replace(/^.+,/,"");if(console.log(l),console.log(s),confirm(`You are about to update ${l[0]}'s entry. Is that what you want ?`))try{i.put(`https://character-database.becode.xyz/characters/${t}`,{image:s,name:p,shortDescription:h,description:y}),alert("Character successfully updated!"),window.location.href="index.html"}catch{console.log("There was une couille dans le p\xE2t\xE9")}})}catch{alert("There was an error while getting the character informations. Has it been removed by someone else ?"),window.location.href="index.html"}document.querySelector("#form_Submit").value="Update Character!"}})();
