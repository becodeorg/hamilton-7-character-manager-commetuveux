import{a as s}from"./axios.da025002.js";(async()=>{document.querySelector("input[type=file]").addEventListener("change",u);function u(){let r=document.querySelector("input[type=file]").files;if(r.length>0){let t=r[0],e=new FileReader;e.onload=function(c){let o=c.target.result;pictureImage.src=o,console.log(document.getElementById("pictureImage").src)},e.readAsDataURL(t)}}const m=window.location.href;if(new URL(m).search.split("?")[1]===void 0)document.querySelector("#form_Submit").addEventListener("click",r=>{r.preventDefault();const t=Array.from(document.querySelectorAll("input[type=text]")).map(({value:a})=>a.trim()),[e,c]=t,o=Array.from(document.querySelector(".ql-editor").children,({innerHTML:a})=>a.trim()).filter(Boolean).join("<br>");console.log(o);const n=document.getElementById("pictureImage").src.replace("data:image/","").replace(/^.+,/,"");if(console.log(t),confirm(`You are about to create a new entry for ${t[0]}. Is that what you want ?`))try{s.post("https://character-database.becode.xyz/characters",{image:n,name:e,shortDescription:c,description:o}),alert("Character successfully added!"),window.location.href="index.html"}catch{console.log("There was une couille dans le p\xE2t\xE9")}});else{const r=window.location.href,t=new URL(r).search.split("?")[1];try{const e=await(await s.get(`https://character-database.becode.xyz/characters/${t}`)).data;console.log(e),console.log(t);const c=document.querySelector("input[name=`name`]"),o=document.querySelector("input[name=`nickname`]"),n=document.querySelector("#editor"),a=document.querySelector("#pictureImage");console.log(a),c.value=e.name,o.value=e.shortDescription,n.innerHTML=e.description,a.src=`data:image;base64,${e.image}`,document.querySelector("#form_Submit").addEventListener("click",h=>{h.preventDefault();const l=Array.from(document.querySelectorAll("input[type=text]")).map(({value:i})=>i.trim()),[p,y]=l,f=Array.from(document.querySelector(".ql-editor").children,({innerHTML:i})=>i.trim()).filter(Boolean).join("<br>"),d=document.getElementById("pictureImage").src.replace("data:image/","").replace(/^.+,/,"");if(console.log(l),console.log(d),confirm(`You are about to update ${l[0]}'s entry. Is that what you want ?`))try{s.put(`https://character-database.becode.xyz/characters/${t}`,{image:d,name:p,shortDescription:y,description:f}),alert("Character successfully updated!"),window.location.href="index.html"}catch{console.log("There was une couille dans le p\xE2t\xE9")}})}catch{alert("There was an error while getting the character informations. Has it been removed by someone else ?"),window.location.href="index.html"}document.querySelector("#form_Submit").value="Update Character!"}new Quill("#editor",{modules:{toolbar:[[{header:[1,2,3,4,5,6]}],["bold","italic","underline"],["code-block"]]},placeholder:"Please enter the character's description.",theme:"snow"})})();
