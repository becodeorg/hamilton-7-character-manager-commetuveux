import{a as s}from"./axios.da025002.js";(async()=>{document.querySelector("input[type=file]").addEventListener("change",d);function d(){let o=document.querySelector("input[type=file]").files;if(o.length>0){let t=o[0],e=new FileReader;e.onload=function(c){let r=c.target.result;pictureImage.src=r,console.log(document.getElementById("pictureImage").src)},e.readAsDataURL(t)}}const m=window.location.href;if(new URL(m).search.split("?")[1]===void 0)document.querySelector("#form_Submit").addEventListener("click",o=>{o.preventDefault();const t=Array.from(document.querySelectorAll("input[type=text]")).map(({value:a})=>a.trim()),[e,c]=t,r=Array.from(document.querySelector(".ql-editor").children,({innerHTML:a})=>a.trim()).filter(Boolean).join("<br>");console.log(r);const l=document.getElementById("pictureImage").src.replace("data:image/","").replace(/^.+,/,"");if(console.log(t),confirm(`You are about to create a new entry for ${t[0]}. Is that what you want ?`))try{s.post("https://character-database.becode.xyz/characters",{image:l,name:e,shortDescription:c,description:r}),alert("Character successfully added!"),window.location.href="index.html"}catch{console.log("There was une couille dans le p\xE2t\xE9")}});else{const o=window.location.href,t=new URL(o).search.split("?")[1];try{const e=await(await s.get(`https://character-database.becode.xyz/characters/${t}`)).data;console.log(e),console.log(t);const c=document.querySelector('input[name="name"]'),r=document.querySelector('input[name="nickname"]'),l=document.querySelector("#editor"),a=document.querySelector("#pictureImage");console.log(a),c.value=e.name,r.value=e.shortDescription,l.innerHTML=e.description,a.src=`data:image;base64,${e.image}`,document.querySelector("#form_Submit").addEventListener("click",h=>{h.preventDefault();const i=Array.from(document.querySelectorAll("input[type=text]")).map(({value:n})=>n.trim()),[p,y]=i,g=Array.from(document.querySelector(".ql-editor").children,({innerHTML:n})=>n.trim()).filter(Boolean).join("<br>"),u=document.getElementById("pictureImage").src.replace("data:image/","").replace(/^.+,/,"");if(console.log(i),console.log(u),confirm(`You are about to update ${i[0]}'s entry. Is that what you want ?`))try{s.put(`https://character-database.becode.xyz/characters/${t}`,{image:u,name:p,shortDescription:y,description:g}),alert("Character successfully updated!"),window.location.href="index.html"}catch(n){console.log("There was une couille dans le p\xE2t\xE9"),console.log(n)}})}catch(e){alert("There was an error while getting the character informations. Has it been removed by someone else ?"),console.log(e)}document.querySelector("#form_Submit").value="Update Character!"}new Quill("#editor",{modules:{toolbar:[[{header:[1,2,3,4,5,6]}],["bold","italic","underline"],["code-block"]]},placeholder:"Please enter the character's description.",theme:"snow"})})();
